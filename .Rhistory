# Period comparisons
period_comparisons <- list( c("q1", "q2"), c("q2", "q3"), c("q3", "q4"),
c("q1", "q3"), c("q2", "q4"), c("q1", "q4") )
# Opto comparisons
opto_comparisons <- list( c("True", "False") )
# Day comparisons
day_comparisons <- list( c("1", "2"), c("2", "3"), c("3", "4"), c("4", "5"))
patha = "C:/Users/serce/Desktop/combined_2.csv"
df <- read_csv(patha)
df <- df %>% dplyr::rename('frame' = 'X1')
df$group <- as.factor(df$group)
df$day <- as.factor(df$day)
# Group comparisons
group_comparisons <- list( c("chr", "ctrl"), c("ctrl", "hr"), c("chr", "hr") )
# Period comparisons
period_comparisons <- list( c("q1", "q2"), c("q2", "q3"), c("q3", "q4"),
c("q1", "q3"), c("q2", "q4"), c("q1", "q4") )
# Opto comparisons
opto_comparisons <- list( c("True", "False") )
# Day comparisons
day_comparisons <- list( c("1", "2"), c("2", "3"), c("3", "4"), c("4", "5"))
#13.1 Total locomotion per day averaged animals
df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>%
filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>%
filter(locomotion < 70) %>%
group_by(group, animal, zone) %>%
ggline(x='period', y='locomotion', color='group', fill='group', facet.by = c('zone', 'day'),
add = c("mean_se"), add.params = list(alpha=0.5), size = 1) +
theme_light() +
ylab('Cumulative locomotion (m)') +
#stat_compare_means(label.y = 100) +
#stat_compare_means(comparisons = group_comparisons, aes(method = 'wilcox.test', label = ..p.signif..)) +
color_palette(c("#5f8cde", "#b0b0b0", "#dea15f")) +
fill_palette(c("#5f8cde", "#b0b0b0", "#dea15f")) +
theme(legend.position = 'bottom')
warnings()
#13.1 Total locomotion per day averaged animals
df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>%
filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>%
filter(locomotion < 70) %>%
group_by(group, animal, zone) %>%
ggline(x='period', y='locomotion', color='group', fill='group', facet.by = c('zone', 'day'),
add = c("mean_se"), add.params = list(alpha=0.5), size = 1) +
theme_light() +
ylab('Cumulative locomotion (m)') +
#stat_compare_means(label.y = 100) +
#stat_compare_means(comparisons = group_comparisons, aes(method = 'wilcox.test', label = ..p.signif..)) +
color_palette(c("#5f8cde", "#b0b0b0", "#dea15f")) +
fill_palette(c("#5f8cde", "#b0b0b0", "#dea15f")) +
theme(legend.position = 'bottom')
library(tidyverse)
library(rstatix)
library(ggpubr)
#13.1 Total locomotion per day averaged animals
df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>%
filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>%
filter(locomotion < 70) %>%
group_by(group, animal, zone) %>%
ggline(x='period', y='locomotion', color='group', fill='group', facet.by = c('zone', 'day'),
add = c("mean_se"), add.params = list(alpha=0.5), size = 1) +
theme_light() +
ylab('Cumulative locomotion (m)') +
#stat_compare_means(label.y = 100) +
#stat_compare_means(comparisons = group_comparisons, aes(method = 'wilcox.test', label = ..p.signif..)) +
color_palette(c("#5f8cde", "#b0b0b0", "#dea15f")) +
fill_palette(c("#5f8cde", "#b0b0b0", "#dea15f")) +
theme(legend.position = 'bottom')
locomotions <- df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>%
filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>%
filter(locomotion < 70) %>%
group_by(group, animal, zone) %>%
filter(period == 'q1')
df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>%
filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion))
df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>%
filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% group_by(group, day, period, zone)
warnings()
df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>%
filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% group_by(group, day, period, zone) %>%
mutate(zone_average=mean(locomotion))
df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>%
filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% group_by(group, day, period, zone) %>%
mutate(zone_avg_loc=mean(locomotion)) %>% group_by(group, animal, day, period, zone) %>%
mutate(normalized_loco=locomotion/zone_avg_loc)
df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>%
filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% group_by(group, day, period, zone) %>%
mutate(zone_avg_loc=mean(locomotion))
#Alternative approach
df
df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100)
#Alternative approach
df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion))
#Alternative approach
df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% filter(period=='q1')
#Alternative approach
df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% filter(period=='q1') %>% .$locomotion
#Alternative approach
q1_locos_per_group_animal_day_period_zone %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% filter(period=='q1') %>% .$locomotion
#Alternative approach
q1_locos_per_group_animal_day_period_zone <- df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% filter(period=='q1') %>% .$locomotion
df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion))
df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion))
q1_locos_per_group_animal_day_period_zone <- df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion))
#Alternative approach
q1_locos_per_group_animal_day_period_zone <- df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% filter(period=='q1') %>% .$locomotion
df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion))
df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% filter(period=='q1')
df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% filter(period=='q1') %>% subset(-c(period))
df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% filter(period=='q1') %>% subset(-c('period'))
df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% filter(period=='q1') %>% select(!c(period))
#Alternative approach
q1_locos_per_group_animal_day_period_zone <- df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% filter(period=='q1') %>% .$locomotion
df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion))
df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion))
#Alternative approach
q1_locos_per_group_animal_day_period_zone <- df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion))
#Alternative approach
q1_locos_per_group_animal_day_period_zone <- df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% ungroup(period)
#Alternative approach
q1_locos_per_group_animal_day_period_zone <- df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% ungroup()
#Alternative approach
q1_locos_per_group_animal_day_period_zone <- df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% ungroup(period) %>% head()
#Alternative approach
q1_locos_per_group_animal_day_period_zone <- df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% ungroup() %>% head()
#Alternative approach
df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% ungroup() %>% head()
#Alternative approach
df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% ungroup(period) %>% head()
#Alternative approach
df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% .$locomotion
#Alternative approach
df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% head()
#Alternative approach
df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% filter(period=='q1')
#Alternative approach
df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% filter(period=='q1') %>% rename(q1_loco=locomotion)
#Alternative approach
df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% filter(period=='q1') %>% rename(q1_loco=locomotion) %>%
ungroup()
#Alternative approach
df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% filter(period=='q1') %>% rename(q1_loco=locomotion) %>%
ungroup()
#Alternative approach
df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% filter(period=='q1') %>% rename(q1_loco=locomotion) %>%
ungroup() %>% select(!c(period))
#Alternative approach
q1_loco <- df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% filter(period=='q1') %>% rename(q1_loco=locomotion) %>%
ungroup() %>% select(!c(period))
df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% merge(q1_loco)
#Alternative approach
q1_loco <- df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% filter(period=='q1') %>% rename(q1_loco=locomotion) %>%
ungroup() %>% select(!c(period))
df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% ungroup()
df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% ungroup() %>% merge(q1_loco) %>%
group_by(group, animal, day, period, zone)
#Alternative approach
q1_loco <- df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% filter(period=='q1') %>% rename(q1_loco=locomotion) %>%
ungroup() %>% select(!c(period))
df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% filter(period=='q1') %>% rename(q1_loco=locomotion) %>%
ungroup() %>% select(!c(period))
df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion))
View(q1_loco)
df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% merge(q1_loco)
df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% merge(q1_loco) %>%
group_by(group, animal, day, period, zone) %>% mutate(normalized=locomotion/q1_loco)
#Alternative approach
loco_q1 <- df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% filter(period=='q1') %>% rename(q1_loco=locomotion) %>%
select(!c(period))
df_normalized_loco <- df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% merge(q1_loco) %>%
group_by(group, animal, day, period, zone) %>% mutate(normalized=locomotion/loco_q1)
df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% merge(q1_loco) %>%
group_by(group, animal, day, period, zone) %>% mutate(normalized=locomotion/loco_q1)
rlang::last_error()
df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% filter(period=='q1') %>% rename(q1_loco=locomotion)
df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% filter(period=='q1') %>% rename(q1_loco=locomotion) %>%
select(!c(period))
#Alternative approach
loco_q1 <- df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% filter(period=='q1') %>% rename(q1_loco=locomotion) %>%
select(!c(period))
df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion))
1122/318
318*4
318*3
df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% merge(q1_loco)
df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% merge(q1_loco) %>%
group_by(group, animal, day, period, zone)
#Alternative approach
loco_q1_df <- df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% filter(period=='q1') %>% rename(q1_loco=locomotion) %>%
select(!c(period))
df_normalized_loco <- df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% merge(loco_q1_df) %>%
group_by(group, animal, day, period, zone) %>% mutate(normalized=locomotion/q1_loco)
View(df_normalized_loco)
df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% merge(loco_q1_df)
loco_q1_df <- df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% filter(period=='q1') %>% rename(q1_loco=locomotion) %>%
select(!c(period))
#Alternative approach
loco_q1_df <- df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% filter(period=='q1') %>% rename(q1_loco=locomotion) %>%
ungroup() %>% select(!c(period))
df_normalized_loco <- df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% merge(loco_q1_df) %>%
group_by(group, animal, day, period, zone) %>% mutate(normalized=locomotion/q1_loco)
df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% merge(loco_q1_df) %>%
group_by(group, animal, day, period, zone) %>% mutate(normalized=locomotion/q1_loco)
df_normalized_loco <- df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% merge(loco_q1_df) %>%
group_by(group, animal, day, period, zone) %>% mutate(normalized_loco=locomotion/q1_loco)
df_normalized_loco <- df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% merge(loco_q1_df) %>%
group_by(group, animal, day, period, zone) %>% mutate(normalized_loco=locomotion/q1_loco)
df_normalized_loco %>%
ggline(x='period', y='normalized_loco', color='group', fill='group', facet.by = c('zone', 'day'),
add = c("mean_se"), add.params = list(alpha=0.5), size = 1) +
theme_light() +
ylab('Cumulative locomotion (m)') +
#stat_compare_means(label.y = 100) +
#stat_compare_means(comparisons = group_comparisons, aes(method = 'wilcox.test', label = ..p.signif..)) +
color_palette(c("#5f8cde", "#b0b0b0", "#dea15f")) +
fill_palette(c("#5f8cde", "#b0b0b0", "#dea15f")) +
theme(legend.position = 'bottom')
#Alternative approach
loco_q1_df <- df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% filter(period=='q1') %>% rename(q1_loco=locomotion) %>%
ungroup() %>% select(!c(period))
df_normalized_loco <- df %>% group_by(group, animal, day, period, zone) %>%
summarise(locomotion = (max(cum_dist_cm, na.rm=TRUE)-min(cum_dist_cm, na.rm=TRUE))/100) %>%
filter(zone != 'drinking') %>% filter(zone != 'unclassified') %>% filter(zone != 'eating') %>%
filter(group != 'hr') %>% filter(animal != 'chr8') %>% filter(animal != 'chr9') %>%
filter(!is.infinite(locomotion)) %>% merge(loco_q1_df) %>%
group_by(group, animal, day, period, zone) %>% mutate(normalized_loco=locomotion/q1_loco)
df_normalized_loco %>%
ggline(x='period', y='normalized_loco', color='group', fill='group', facet.by = c('zone', 'day'),
add = c("mean_se"), add.params = list(alpha=0.5), size = 1) +
theme_light() +
ylab('Cumulative locomotion (m)') +
#stat_compare_means(label.y = 100) +
#stat_compare_means(comparisons = group_comparisons, aes(method = 'wilcox.test', label = ..p.signif..)) +
color_palette(c("#5f8cde", "#b0b0b0", "#dea15f")) +
fill_palette(c("#5f8cde", "#b0b0b0", "#dea15f")) +
theme(legend.position = 'bottom')
